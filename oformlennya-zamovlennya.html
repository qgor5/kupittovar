<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Оформлення замовлення</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; background: #f9f9f9; }
    .product-summary { display: flex; align-items: center; gap: 20px; background: #fff; padding: 15px; border-radius: 8px; margin-bottom: 20px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); }
    .product-summary img { width: 100px; height: auto; border-radius: 8px; }
    .product-details { flex: 1; }
    .quantity-controls { display: flex; align-items: center; gap: 10px; }
    .quantity-controls button { padding: 5px 10px; font-size: 16px; }
    .order-form { background: #fff; padding: 20px; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); }
    .order-form input, .order-form textarea { width: 100%; padding: 10px; margin-bottom: 15px; border-radius: 4px; border: 1px solid #ccc; }
    .order-form button { padding: 10px 20px; font-size: 16px; cursor: pointer; background-color: #4CAF50; color: white; border: none; border-radius: 4px; }
    .order-form button.back { background-color: #777; margin-left: 10px; }
    .total { font-weight: bold; margin-top: 10px; }
  </style>
</head>
<body>

  <h1>Оформлення замовлення</h1>

  <div class="product-summary">
    <img id="productImage" src="" alt="Товар">
    <div class="product-details">
      <h2 id="productName">Назва товару</h2>
      <p>Ціна: <span id="productPrice">0</span> грн</p>
      <div class="quantity-controls">
        <button type="button" onclick="changeQuantity(-1)">−</button>
        <input type="number" id="productQty" value="1" min="1" style="width: 50px; text-align: center;">
        <button type="button" onclick="changeQuantity(1)">+</button>
      </div>
      <p class="total">Сума: <span id="totalPrice">0</span> грн</p>
    </div>
  </div>

  <form class="order-form" action="order-success.html" method="GET">
    <input type="text" name="full_name" placeholder="ПІБ" required>
    <input type="tel" name="phone" placeholder="Телефон" required>
    <textarea name="address" placeholder="Адреса доставки" required></textarea>

    <!-- Приховані поля -->
    <input type="hidden" name="product_name" id="hiddenProductName">
    <input type="hidden" name="product_image" id="hiddenProductImage">
    <input type="hidden" name="product_price" id="hiddenProductPrice">
    <input type="hidden" name="product_quantity" id="hiddenProductQty">
    <input type="hidden" name="total_price" id="hiddenTotalPrice">

    <button type="submit">Підтвердити замовлення</button>
    <button type="button" class="back" onclick="window.location.href='kozhani-korzina.html'">Повернутись до кошика</button>
  </form>

  <script>
    function getQueryParam(name) {
      const urlParams = new URLSearchParams(window.location.search);
      return urlParams.get(name);
    }

    function updateSummary() {
      const price = parseFloat(getQueryParam('price')) || 0;
      const qty = parseInt(document.getElementById('productQty').value);
      const total = price * qty;

      document.getElementById('totalPrice').textContent = total.toFixed(2);
      document.getElementById('hiddenProductQty').value = qty;
      document.getElementById('hiddenTotalPrice').value = total.toFixed(2);
    }

    function changeQuantity(change) {
      const qtyInput = document.getElementById('productQty');
      let qty = parseInt(qtyInput.value);
      qty = isNaN(qty) ? 1 : qty + change;
      qty = qty < 1 ? 1 : qty;
      qtyInput.value = qty;
      updateSummary();
    }

    // Заповнення даних при завантаженні
    window.onload = () => {
      const name = getQueryParam('productName') || 'Товар';
      const img = getQueryParam('productImage') || 'placeholder.jpg';
      const price = parseFloat(getQueryParam('price')) || 0;
      const qty = parseInt(getQueryParam('qty')) || 1;

      document.getElementById('productName').textContent = name;
      document.getElementById('productImage').src = img;
      document.getElementById('productPrice').textContent = price.toFixed(2);
      document.getElementById('productQty').value = qty;
      document.getElementById('totalPrice').textContent = (price * qty).toFixed(2);

      // Приховані поля
      document.getElementById('hiddenProductName').value = name;
      document.getElementById('hiddenProductImage').value = img;
      document.getElementById('hiddenProductPrice').value = price.toFixed(2);
      document.getElementById('hiddenProductQty').value = qty;
      document.getElementById('hiddenTotalPrice').value = (price * qty).toFixed(2);
    };
  </script>

</body>
</html>
